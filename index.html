<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Recettes - Cuisine Saine</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { font-family: 'Montserrat', sans-serif; background:#F0EDE5; color:#333; padding:20px; }
    h1,h3 { font-family:'Dancing Script', cursive; color:#6B3A1E; }
    .card { transition: transform .3s; }
    .card:hover { transform: scale(1.03); }
    .btn-brown { background:#6B3A1E; color:#fff; border:none; padding:8px 16px; border-radius:6px; }
    .btn-brown:hover { background:#8B4513; }
    #recipes-container, #recipe-content { display:none; margin-top:20px; }
  </style>
</head>
<body>

<h1 class="text-center mb-4">Nos Recettes</h1>

<!-- Niveau 1 : Catégories -->
<div id="categories-container" class="row g-4"></div>

<!-- Niveau 2 : Recettes -->
<div id="recipes-container" class="row g-4"></div>

<!-- Niveau 3 : Détail -->
<div id="recipe-content"></div>

<script>
document.addEventListener("DOMContentLoaded", ()=> {

  let recipesData = {recipes:[]};

  // Charger le JSON externe
  async function loadRecipes(){
    try {
      const res = await fetch("recettes.json"); 
      recipesData = await res.json();
      showCategories();
    } catch(e){
      console.error("Erreur lors du chargement JSON:",e);
    }
  }

  const catContainer=document.getElementById("categories-container");
  const recContainer=document.getElementById("recipes-container");
  const recipeDiv=document.getElementById("recipe-content");

  // Niveau 1 : afficher catégories
  function showCategories(){
    catContainer.innerHTML="";
    recContainer.style.display="none";
    recipeDiv.style.display="none";
    const categories=[...new Set(recipesData.recipes.map(r=>r.category))];

    categories.forEach(cat=>{
      catContainer.innerHTML += `
      <div class="col-12 col-md-6">
        <div class="card h-100 shadow-sm">
          <div class="card-body text-center">
            <h5 class="card-title">${cat}</h5>
            <button class="btn btn-brown" onclick="showRecipes('${cat}')">Voir les recettes</button>
          </div>
        </div>
      </div>`;
    });
  }

  // Niveau 2 : recettes d’une catégorie
  window.showRecipes=function(category){
    catContainer.style.display="none";
    recipeDiv.style.display="none";
    recContainer.style.display="flex";
    recContainer.innerHTML="";

    recipesData.recipes.forEach((r,i)=>{
      if(r.category===category){
        recContainer.innerHTML += `
        <div class="col-12 col-md-6">
          <div class="card h-100 shadow-sm">
            <div class="card-body">
              <h5 class="card-title">${r.title}</h5>
              <button class="btn btn-brown" onclick="showRecipe(${i})">Détails</button>
            </div>
          </div>
        </div>`;
      }
    });

    recContainer.innerHTML += `
      <div class="col-12">
        <button class="btn btn-brown" onclick="showCategories()">⬅ Retour aux catégories</button>
      </div>`;
  }

  // Niveau 3 : détail recette
  window.showRecipe=function(index){
    const r=recipesData.recipes[index];
    recContainer.style.display="none"; 
    recipeDiv.style.display="block";
    let ingredientsHTML="";
    if(Array.isArray(r.ingredients)){
      ingredientsHTML=`<ul>${r.ingredients.map(i=>`<li>${i}</li>`).join("")}</ul>`;
    } else {
      for(const part in r.ingredients){
        ingredientsHTML += `<h5>${part}</h5><ul>${r.ingredients[part].map(i=>`<li>${i}</li>`).join("")}</ul>`;
      }
    }
    let bienfaitsHTML="";
    if(r.bienfaits){
      bienfaitsHTML="<div class='mt-3 p-2 bg-light border rounded'><h5>Bienfaits</h5><ul>";
      for(const key in r.bienfaits){
        bienfaitsHTML+=`<li><b>${key.replace(/_/g," ")}:</b> ${r.bienfaits[key]}</li>`;
      }
      bienfaitsHTML+="</ul></div>";
    }

    recipeDiv.innerHTML=`
      <div class="card">
        <div class="card-body">
          <h3>${r.title}</h3>
          <p><em>${r.category}</em></p>
          ${r.portion? `<p><b>Portions :</b> ${r.portion}</p>`:""}
          <h4>Ingrédients</h4>${ingredientsHTML}
          <h4>Préparation</h4><ol>${r.preparation.map(p=>`<li>${p}</li>`).join("")}</ol>
          ${r.astuce? `<div class="mt-3 p-2 bg-warning-subtle border rounded"><b>Astuce:</b> ${r.astuce}</div>`:""}
          ${bienfaitsHTML}
          <div class="mt-3">
            <button class="btn btn-brown" onclick="showRecipes('${r.category}')">⬅ Retour aux recettes</button>
            <button class="btn btn-brown" onclick="showCategories()">⬅ Retour aux catégories</button>
          </div>
        </div>
      </div>`;
  };

  loadRecipes();

});
</script>
</body>
</html>
